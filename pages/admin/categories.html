<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Â· Categories</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            kkpink: '#ff69b4',
          }
        }
      }
    }
  </script>

  <!-- KK base + components -->
  <link rel="stylesheet" href="/css/theme/base.css">
  <link rel="stylesheet" href="/css/theme/components.css">

  <style>
    /* Custom scrollbar for tables */
    .custom-scrollbar::-webkit-scrollbar { height: 8px; }
    .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background: #000; }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #333; }

    /* Row hover effect */
    .category-row:hover { background: #fafafa; }
    .category-row:hover .row-actions { opacity: 1; }
    .row-actions { opacity: 0.5; transition: opacity 0.15s; }

    /* Status badge */
    .status-active { background: #dcfce7; color: #166534; }
    .status-inactive { background: #fee2e2; color: #991b1b; }

    /* Mobile improvements */
    @media (max-width: 640px) {
      button, [role="button"] { min-height: 44px; }
      input, select, textarea { font-size: 16px !important; }
    }
  </style>
</head>

<body class="kk-page kk-admin bg-gray-50 min-h-screen">
  <!-- Admin Nav mount -->
  <div id="kkAdminNavMount"></div>

  <main class="max-w-7xl mx-auto px-2 sm:px-6 py-4 sm:py-8">

    <!-- Header Card -->
    <header class="bg-white rounded-2xl shadow-sm border border-gray-200 p-4 sm:p-6 mb-4 sm:mb-6">
      <div class="flex flex-col gap-4">
        <div>
          <div class="inline-block bg-black text-white px-2 py-1 text-[10px] font-black uppercase tracking-[.25em] mb-2">
            Admin Panel
          </div>
          <h1 class="text-2xl sm:text-4xl font-black tracking-tight">
            Categories
          </h1>
          <p class="text-xs sm:text-sm text-gray-500 mt-1">
            Manage category labels, homepage images, and display order
          </p>
        </div>
        <div class="flex gap-2">
          <button
            id="btnNewCategory"
            type="button"
            class="border-4 border-black bg-black text-white px-3 sm:px-6 py-2 sm:py-3 font-black uppercase tracking-[.12em] sm:tracking-[.15em] text-[10px] sm:text-sm
                   hover:bg-kkpink hover:border-kkpink hover:text-black transition-all text-center"
          >
            + New Category
          </button>
        </div>
      </div>
    </header>

    <!-- Search & Count -->
    <section class="bg-white rounded-2xl shadow-sm border border-gray-200 p-3 sm:p-4 mb-4 sm:mb-6">
      <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 items-stretch sm:items-end">
        <!-- Search -->
        <div class="flex-1">
          <label for="searchInput"
                 class="block text-[9px] sm:text-[10px] font-black uppercase tracking-[.18em] mb-1 sm:mb-2 text-gray-500">
            Search Categories
          </label>
          <div class="relative">
            <input
              id="searchInput"
              type="search"
              placeholder="Search..."
              class="w-full border-4 border-black px-3 sm:px-4 py-2 sm:py-3 text-sm outline-none pr-10 focus:border-kkpink transition-colors"
            />
            <svg class="absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
          </div>
        </div>

        <!-- Count -->
        <div class="flex items-center justify-between sm:justify-end gap-3">
          <div class="text-xs sm:text-sm font-bold uppercase tracking-wider text-gray-500" id="countLabel">
            0 categories
          </div>
        </div>
      </div>
    </section>

    <!-- Table -->
    <section id="tableWrap" class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden">
      <!-- Mobile Card View -->
      <div id="mobileCategoryCards" class="sm:hidden"></div>
      
      <!-- Desktop Table View -->
      <div class="hidden sm:block overflow-x-auto custom-scrollbar">
        <table class="w-full border-collapse text-sm">
          <thead class="bg-black text-white">
            <tr class="text-left uppercase tracking-[.12em] text-[11px] font-black">
              <th class="px-4 py-4">Name</th>
              <th class="px-4 py-4">Slug</th>
              <th class="px-4 py-4">Home Image</th>
              <th class="px-4 py-4 text-center">Order</th>
              <th class="px-4 py-4 text-center">Status</th>
              <th class="px-4 py-4 text-right">Actions</th>
            </tr>
          </thead>
          <tbody id="categoryRows" class="divide-y divide-gray-200"></tbody>
        </table>
      </div>

      <!-- Empty State -->
      <div id="emptyState" class="hidden p-8 text-center">
        <div class="text-4xl mb-3">ðŸ“‚</div>
        <div class="text-gray-500 text-sm">No categories found</div>
      </div>
    </section>

  </main>

  <!-- MODAL -->
  <div id="categoryModal" class="hidden fixed inset-0 z-[200]" aria-hidden="true">
    <!-- Backdrop -->
    <div id="categoryModalBackdrop" class="absolute inset-0 bg-black/60 backdrop-blur-sm"></div>

    <!-- Stage -->
    <div class="relative h-full w-full overflow-y-auto">
      <div class="min-h-full flex items-end sm:items-center justify-center p-0 sm:p-6">
        <!-- Card -->
        <div class="w-full sm:max-w-2xl bg-white border-0 sm:border-4 border-black shadow-none sm:shadow-[8px_8px_0_0_rgba(0,0,0,0.1)] min-h-screen sm:min-h-0">
          <!-- Head -->
          <div class="sticky top-0 z-10 flex items-center justify-between gap-3 p-3 sm:p-5 border-b-4 border-black bg-white">
            <div class="min-w-0">
              <div class="inline-block bg-kkpink text-black px-2 py-0.5 text-[8px] sm:text-[9px] font-black uppercase tracking-[.2em] mb-1">
                Category Editor
              </div>
              <h3 id="modalTitle" class="text-lg sm:text-2xl font-black tracking-tight truncate">
                Edit Category
              </h3>
            </div>

            <button
              id="btnCloseModal"
              type="button"
              class="border-4 border-black bg-white w-10 h-10 flex items-center justify-center font-black text-lg
                     hover:bg-black hover:text-white transition-colors flex-shrink-0"
              aria-label="Close"
            >
              âœ•
            </button>
          </div>

          <!-- Body -->
          <div class="p-3 sm:p-6 space-y-4 sm:space-y-6 pb-24 sm:pb-6">
            <div class="grid sm:grid-cols-2 gap-4">
              <!-- Name -->
              <div>
                <label for="fName" class="block text-[11px] font-black uppercase tracking-[.12em] mb-1 text-black/70">
                  Name
                </label>
                <input id="fName" class="w-full border-[4px] border-black px-3 py-2 text-sm outline-none focus:border-kkpink transition-colors"
                  placeholder="e.g. Headwear" />
                <p class="text-xs text-gray-500 mt-1">Shown on chips + category strip</p>
              </div>

              <!-- Slug -->
              <div>
                <label for="fSlug" class="block text-[11px] font-black uppercase tracking-[.12em] mb-1 text-black/70">
                  Slug
                </label>
                <input id="fSlug" class="w-full border-[4px] border-black px-3 py-2 text-sm outline-none focus:border-kkpink transition-colors"
                  placeholder="e.g. headwear" />
                <p class="text-xs text-gray-500 mt-1">Used for URLs & filtering</p>
              </div>

              <!-- Home Image -->
              <div class="sm:col-span-2">
                <label for="fImage" class="block text-[11px] font-black uppercase tracking-[.12em] mb-1 text-black/70">
                  Home Image URL
                </label>
                <input id="fImage" class="w-full border-[4px] border-black px-3 py-2 text-sm outline-none focus:border-kkpink transition-colors"
                  placeholder="https://... or categories/headwear.jpg" />
                <p class="text-xs text-gray-500 mt-1">Image shown on the homepage category strip</p>
              </div>

              <!-- Sort Order -->
              <div>
                <label for="fOrder" class="block text-[11px] font-black uppercase tracking-[.12em] mb-1 text-black/70">
                  Sort Order
                </label>
                <input id="fOrder" type="number" class="w-full border-[4px] border-black px-3 py-2 text-sm outline-none focus:border-kkpink transition-colors"
                  placeholder="10" />
                <p class="text-xs text-gray-500 mt-1">Lower numbers appear first</p>
              </div>

              <!-- Active Toggle -->
              <div class="flex items-center gap-3 pt-6">
                <input id="fActive" type="checkbox" class="h-5 w-5 border-[4px] border-black accent-kkpink" />
                <label for="fActive" class="text-sm font-black uppercase tracking-[.12em]">
                  Active (visible on site)
                </label>
              </div>
            </div>

            <!-- Message -->
            <div id="modalMsg" class="hidden p-3 border-4 border-red-300 bg-red-50 text-red-700 text-sm"></div>
          </div>

          <!-- Foot -->
          <div class="sticky bottom-0 flex items-center justify-between gap-3 p-3 sm:p-5 border-t-4 border-black bg-gray-50">
            <p class="text-xs text-gray-500 hidden sm:block">Tip: space out sort orders (10, 20, 30) for easier reordering</p>
            <div class="flex gap-2 ml-auto">
              <button
                id="btnDeleteCategory"
                type="button"
                class="border-4 border-red-500 bg-white text-red-500 px-4 py-2 font-black uppercase tracking-[.12em] text-xs
                       hover:bg-red-500 hover:text-white transition-all hidden"
              >
                Delete
              </button>
              <button
                id="btnSaveCategory"
                type="button"
                class="border-4 border-black bg-black text-white px-6 py-2 font-black uppercase tracking-[.12em] text-xs
                       hover:bg-kkpink hover:border-kkpink hover:text-black transition-all"
              >
                Save
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer mount -->
  <div id="kkFooterMount"></div>

  <!-- Click backdrop to close -->
  <script>
    (function () {
      const modal = document.getElementById("categoryModal");
      const backdrop = document.getElementById("categoryModalBackdrop");
      const closeBtn = document.getElementById("btnCloseModal");
      if (!modal || !backdrop || !closeBtn) return;
      backdrop.addEventListener("click", () => closeBtn.click());
    })();
  </script>

  <script type="module" src="/js/admin/categories/index.js"></script>
</body>
</html>
